<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Dashboard - Users Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="stylesheet" href="/admin/css/users.css?v=1.1">
</head>

<body>
  <div class="container-fluid">
    <div class="row">
      <%- include('partials/sideBar') %>

      <main class="content-wrapper col-md-9 ms-sm-auto col-lg-10 px-md-4">
        <div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3">
          <h1 class="h2">Users Management</h1>
        </div>

        <div class="mb-3">
          <input
            id="searchInput"
            class="form-control w-25"
            type="text"
            placeholder="Search users..."
          />
        </div>

        <div class="card shadow-sm">
          <div class="card-body">
            <table class="table table-hover align-middle">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Google User</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="userTableBody">
                <% Users.forEach(user => { %>
                  <tr
                    data-username="<%= user.username.toLowerCase() %>"
                    data-email="<%= user.email.toLowerCase() %>"
                  >
                    <td><%= user.username %></td>
                    <td><%= user.email %></td>
                    <td>
                      <span class="badge <%= user.googleUser ? 'bg-success' : 'bg-secondary' %>">
                        <%= user.googleUser ? 'Yes' : 'No' %>
                      </span>
                    </td>
                    <td>
                      <button
                        class="btn btn-sm btn-<%= user.block ? 'danger' : 'success' %> toggle-block-btn"
                        data-id="<%= user._id %>"
                      >
                        <%= user.block ? 'Unblock' : 'Block' %>
                      </button>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        </div>

        <nav class="mt-4">
          <ul class="pagination justify-content-center">
            <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
              <a class="page-link" href="/admin/users?page=<%= currentPage - 1 %>">Previous</a>
            </li>

            <% for (let i = 1; i <= totalPages; i++) { %>
              <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                <a class="page-link" href="/admin/users?page=<%= i %>"><%= i %></a>
              </li>
            <% } %>

            <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
              <a class="page-link" href="/admin/users?page=<%= currentPage + 1 %>">Next</a>
            </li>
          </ul>
        </nav>
      </main>
    </div>
  </div>
  <!-- Global libs -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <!-- Page JS -->
 <script type="module" src="/admin/js/users.js"></script>
</body>
</html>
